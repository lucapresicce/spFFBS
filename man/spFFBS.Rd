% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FFBS-DYNBPS.R
\name{spFFBS}
\alias{spFFBS}
\title{spFFBS: Spatiotemporal Bayesian Pipeline (friendly interface)}
\usage{
spFFBS(
  Y,
  G,
  P,
  D,
  grid = list(tau = NULL, phi = NULL),
  prior,
  do_BS = FALSE,
  do_forecast = FALSE,
  do_spatial = FALSE,
  L = 200,
  tnew = NULL,
  spatial = NULL
)
}
\arguments{
\item{Y}{Response data (3D array or cube).}

\item{G}{System matrix (cube).}

\item{P}{Observation matrix (cube).}

\item{D}{Spatial distance matrix.}

\item{grid}{List with elements:
\itemize{
\item tau: numeric vector
\item phi: numeric vector
}}

\item{prior}{Prior list for forward filter (m, C, nu, Psi)}

\item{do_BS}{Logical: run backward sampling? (default: FALSE)}

\item{do_forecast}{Logical: run temporal forecasts? (default: FALSE)}

\item{do_spatial}{Logical: run spatial interpolation? (default: FALSE)}

\item{L}{Number of posterior samples (default 200)}

\item{tnew}{Forecast horizon (default 5)}

\item{spatial}{Optional list for spatial:
list(crd = , crdtilde = , Xtilde = )}
}
\value{
A list with the components executed according to the flags.
}
\description{
A user-friendly, modular wrapper for running a Bayesian spatiotemporal
filtering + weighting pipeline, with optional backward sampling,
forecasting, and spatial interpolation.
}
